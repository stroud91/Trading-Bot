from app.models import db, Transaction, environment, SCHEMA
from sqlalchemy.sql import text
from datetime import datetime

def seed_transactions():
    transactions = [
        Transaction(
            account_id=1,
            market='AAPL',
            side='buy',
            size=100,
            leverage=2,
            liquidation_price=120.00,
            unrealized_pnl=500.00,
            realized_pnl=0.00,
            avg_open_price=130.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=2,
            market='GOOG',
            side='sell',
            size=50,
            leverage=1.5,
            liquidation_price=2000.00,
            unrealized_pnl=-300.00,
            realized_pnl=200.00,
            avg_open_price=2100.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=3,
            market='TSLA',
            side='buy',
            size=80,
            leverage=3,
            liquidation_price=600.00,
            unrealized_pnl=1000.00,
            realized_pnl=500.00,
            avg_open_price=650.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=4,
            market='AMZN',
            side='sell',
            size=60,
            leverage=2.5,
            liquidation_price=3100.00,
            unrealized_pnl=-800.00,
            realized_pnl=400.00,
            avg_open_price=3200.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=5,
            market='MSFT',
            side='buy',
            size=150,
            leverage=1,
            liquidation_price=200.00,
            unrealized_pnl=750.00,
            realized_pnl=0.00,
            avg_open_price=210.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=6,
            market='NFLX',
            side='sell',
            size=40,
            leverage=2,
            liquidation_price=500.00,
            unrealized_pnl=-200.00,
            realized_pnl=100.00,
            avg_open_price=510.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=7,
            market='NVDA',
            side='buy',
            size=120,
            leverage=1.5,
            liquidation_price=480.00,
            unrealized_pnl=600.00,
            realized_pnl=0.00,
            avg_open_price=490.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=8,
            market='BABA',
            side='sell',
            size=70,
            leverage=2,
            liquidation_price=220.00,
            unrealized_pnl=-350.00,
            realized_pnl=150.00,
            avg_open_price=230.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=9,
            market='V',
            side='buy',
            size=90,
            leverage=2.5,
            liquidation_price=190.00,
            unrealized_pnl=450.00,
            realized_pnl=0.00,
            avg_open_price=200.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=10,
            market='JPM',
            side='sell',
            size=110,
            leverage=1,
            liquidation_price=100.00,
            unrealized_pnl=-550.00,
            realized_pnl=250.00,
            avg_open_price=110.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=11,
            market='WMT',
            side='buy',
            size=130,
            leverage=3,
            liquidation_price=140.00,
            unrealized_pnl=650.00,
            realized_pnl=0.00,
            avg_open_price=150.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=12,
            market='MA',
            side='sell',
            size=45,
            leverage=2,
            liquidation_price=350.00,
            unrealized_pnl=-225.00,
            realized_pnl=125.00,
            avg_open_price=360.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=13,
            market='UNH',
            side='buy',
            size=75,
            leverage=1.5,
            liquidation_price=380.00,
            unrealized_pnl=375.00,
            realized_pnl=0.00,
            avg_open_price=390.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=14,
            market='HD',
            side='sell',
            size=95,
            leverage=2,
            liquidation_price=310.00,
            unrealized_pnl=-475.00,
            realized_pnl=225.00,
            avg_open_price=320.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=15,
            market='BAC',
            side='buy',
            size=85,
            leverage=2.5,
            liquidation_price=25.00,
            unrealized_pnl=425.00,
            realized_pnl=0.00,
            avg_open_price=30.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=16,
            market='PG',
            side='sell',
            size=105,
            leverage=1,
            liquidation_price=130.00,
            unrealized_pnl=-525.00,
            realized_pnl=275.00,
            avg_open_price=140.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=17,
            market='VZ',
            side='buy',
            size=115,
            leverage=3,
            liquidation_price=50.00,
            unrealized_pnl=575.00,
            realized_pnl=0.00,
            avg_open_price=55.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=18,
            market='T',
            side='sell',
            size=125,
            leverage=1.5,
            liquidation_price=25.00,
            unrealized_pnl=-625.00,
            realized_pnl=325.00,
            avg_open_price=30.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=19,
            market='KO',
            side='buy',
            size=135,
            leverage=2,
            liquidation_price=45.00,
            unrealized_pnl=675.00,
            realized_pnl=0.00,
            avg_open_price=50.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=20,
            market='PEP',
            side='sell',
            size=145,
            leverage=2.5,
            liquidation_price=135.00,
            unrealized_pnl=-725.00,
            realized_pnl=375.00,
            avg_open_price=140.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=21,
            market='MRK',
            side='buy',
            size=155,
            leverage=1,
            liquidation_price=75.00,
            unrealized_pnl=775.00,
            realized_pnl=0.00,
            avg_open_price=80.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=22,
            market='ORCL',
            side='sell',
            size=165,
            leverage=3,
            liquidation_price=55.00,
            unrealized_pnl=-825.00,
            realized_pnl=425.00,
            avg_open_price=60.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=23,
            market='IBM',
            side='buy',
            size=175,
            leverage=2,
            liquidation_price=125.00,
            unrealized_pnl=875.00,
            realized_pnl=0.00,
            avg_open_price=130.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=24,
            market='INTC',
            side='sell',
            size=185,
            leverage=1.5,
            liquidation_price=45.00,
            unrealized_pnl=-925.00,
            realized_pnl=475.00,
            avg_open_price=50.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=25,
            market='CSCO',
            side='buy',
            size=195,
            leverage=2,
            liquidation_price=40.00,
            unrealized_pnl=975.00,
            realized_pnl=0.00,
            avg_open_price=45.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=26,
            market='CMCSA',
            side='sell',
            size=205,
            leverage=2.5,
            liquidation_price=50.00,
            unrealized_pnl=-1025.00,
            realized_pnl=525.00,
            avg_open_price=55.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=27,
            market='ADBE',
            side='buy',
            size=215,
            leverage=1,
            liquidation_price=460.00,
            unrealized_pnl=1075.00,
            realized_pnl=0.00,
            avg_open_price=470.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=28,
            market='CRM',
            side='sell',
            size=225,
            leverage=3,
            liquidation_price=220.00,
            unrealized_pnl=-1125.00,
            realized_pnl=575.00,
            avg_open_price=230.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=29,
            market='PYPL',
            side='buy',
            size=235,
            leverage=2,
            liquidation_price=240.00,
            unrealized_pnl=1175.00,
            realized_pnl=0.00,
            avg_open_price=250.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=30,
            market='SQ',
            side='sell',
            size=245,
            leverage=1.5,
            liquidation_price=220.00,
            unrealized_pnl=-1225.00,
            realized_pnl=625.00,
            avg_open_price=230.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=31,
            market='UBER',
            side='buy',
            size=255,
            leverage=2,
            liquidation_price=35.00,
            unrealized_pnl=1275.00,
            realized_pnl=0.00,
            avg_open_price=40.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=32,
            market='LYFT',
            side='sell',
            size=265,
            leverage=2.5,
            liquidation_price=45.00,
            unrealized_pnl=-1325.00,
            realized_pnl=675.00,
            avg_open_price=50.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=33,
            market='SNAP',
            side='buy',
            size=275,
            leverage=1,
            liquidation_price=15.00,
            unrealized_pnl=1375.00,
            realized_pnl=0.00,
            avg_open_price=20.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=34,
            market='ZM',
            side='sell',
            size=285,
            leverage=3,
            liquidation_price=350.00,
            unrealized_pnl=-1425.00,
            realized_pnl=725.00,
            avg_open_price=360.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=35,
            market='SHOP',
            side='buy',
            size=295,
            leverage=2,
            liquidation_price=1000.00,
            unrealized_pnl=1475.00,
            realized_pnl=0.00,
            avg_open_price=1010.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=36,
            market='DOCU',
            side='sell',
            size=305,
            leverage=1.5,
            liquidation_price=200.00,
            unrealized_pnl=-1525.00,
            realized_pnl=775.00,
            avg_open_price=210.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=37,
            market='PINS',
            side='buy',
            size=315,
            leverage=2,
            liquidation_price=70.00,
            unrealized_pnl=1575.00,
            realized_pnl=0.00,
            avg_open_price=75.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=38,
            market='ROKU',
            side='sell',
            size=325,
            leverage=2.5,
            liquidation_price=300.00,
            unrealized_pnl=-1625.00,
            realized_pnl=825.00,
            avg_open_price=310.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=39,
            market='SPOT',
            side='buy',
            size=335,
            leverage=1,
            liquidation_price=220.00,
            unrealized_pnl=1675.00,
            realized_pnl=0.00,
            avg_open_price=230.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=40,
            market='SQ',
            side='sell',
            size=345,
            leverage=3,
            liquidation_price=210.00,
            unrealized_pnl=-1725.00,
            realized_pnl=875.00,
            avg_open_price=220.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=41,
            market='AAPL',
            side='buy',
            size=355,
            leverage=2,
            liquidation_price=110.00,
            unrealized_pnl=1775.00,
            realized_pnl=0.00,
            avg_open_price=120.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=42,
            market='GOOG',
            side='sell',
            size=365,
            leverage=1.5,
            liquidation_price=2000.00,
            unrealized_pnl=-1825.00,
            realized_pnl=925.00,
            avg_open_price=2100.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=43,
            market='TSLA',
            side='buy',
            size=375,
            leverage=2,
            liquidation_price=600.00,
            unrealized_pnl=1875.00,
            realized_pnl=0.00,
            avg_open_price=610.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=44,
            market='AMZN',
            side='sell',
            size=385,
            leverage=2.5,
            liquidation_price=3100.00,
            unrealized_pnl=-1925.00,
            realized_pnl=975.00,
            avg_open_price=3200.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=45,
            market='MSFT',
            side='buy',
            size=395,
            leverage=1,
            liquidation_price=200.00,
            unrealized_pnl=1975.00,
            realized_pnl=0.00,
            avg_open_price=210.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=46,
            market='NFLX',
            side='sell',
            size=405,
            leverage=3,
            liquidation_price=500.00,
            unrealized_pnl=-2025.00,
            realized_pnl=1025.00,
            avg_open_price=510.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=47,
            market='NVDA',
            side='buy',
            size=415,
            leverage=2,
            liquidation_price=480.00,
            unrealized_pnl=2075.00,
            realized_pnl=0.00,
            avg_open_price=490.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=48,
            market='BABA',
            side='sell',
            size=425,
            leverage=1.5,
            liquidation_price=220.00,
            unrealized_pnl=-2125.00,
            realized_pnl=1075.00,
            avg_open_price=230.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=49,
            market='V',
            side='buy',
            size=435,
            leverage=2,
            liquidation_price=190.00,
            unrealized_pnl=2175.00,
            realized_pnl=0.00,
            avg_open_price=200.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
        Transaction(
            account_id=50,
            market='JPM',
            side='sell',
            size=445,
            leverage=2.5,
            liquidation_price=100.00,
            unrealized_pnl=-2225.00,
            realized_pnl=1125.00,
            avg_open_price=110.00,
            avg_close_price=None,
            created_at=datetime.utcnow()
        ),
    ]

    db.session.bulk_save_objects(transactions)
    db.session.commit()
    print("Transactions seeded")


def undo_transactions():
    if environment == "production":
        db.session.execute(f"TRUNCATE table {SCHEMA}.transactions RESTART IDENTITY CASCADE;")
    else:
        db.session.execute(text("DELETE FROM transactions"))

    db.session.commit()
