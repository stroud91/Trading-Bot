from app.models import db, Order, environment, SCHEMA
from sqlalchemy.sql import text
from datetime import datetime, timedelta

def seed_orders():
    orders = [
        Order(
            account_id=1,
            market='AAPL',
            side='buy',
            status='completed',
            price=150.25,
            amount=10,
            filled=10,
            trigger='Market',
            good_til=None,
            execution_price=150.25,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=2,
            market='GOOG',
            side='sell',
            status='pending',
            price=2500.00,
            amount=5,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=1),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=3,
            market='TSLA',
            side='buy',
            status='completed',
            price=700.50,
            amount=15,
            filled=15,
            trigger='Market',
            good_til=None,
            execution_price=700.50,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=4,
            market='AMZN',
            side='sell',
            status='pending',
            price=3300.00,
            amount=8,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=2),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=5,
            market='NFLX',
            side='buy',
            status='completed',
            price=550.75,
            amount=20,
            filled=20,
            trigger='Market',
            good_til=None,
            execution_price=550.75,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=6,
            market='MSFT',
            side='buy',
            status='completed',
            price=280.00,
            amount=12,
            filled=12,
            trigger='Market',
            good_til=None,
            execution_price=280.00,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=7,
            market='FB',
            side='sell',
            status='pending',
            price=350.00,
            amount=18,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=3),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=8,
            market='TWTR',
            side='buy',
            status='completed',
            price=65.50,
            amount=30,
            filled=30,
            trigger='Market',
            good_til=None,
            execution_price=65.50,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=9,
            market='DIS',
            side='sell',
            status='pending',
            price=180.00,
            amount=25,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=4),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=10,
            market='NVDA',
            side='buy',
            status='completed',
            price=220.50,
            amount=40,
            filled=40,
            trigger='Market',
            good_til=None,
            execution_price=220.50,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=11,
            market='BABA',
            side='sell',
            status='pending',
            price=200.00,
            amount=10,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=5),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=12,
            market='V',
            side='buy',
            status='completed',
            price=230.75,
            amount=15,
            filled=15,
            trigger='Market',
            good_til=None,
            execution_price=230.75,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=13,
            market='JPM',
            side='sell',
            status='pending',
            price=160.00,
            amount=20,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=6),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=14,
            market='WMT',
            side='buy',
            status='completed',
            price=145.25,
            amount=50,
            filled=50,
            trigger='Market',
            good_til=None,
            execution_price=145.25,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=15,
            market='MA',
            side='sell',
            status='pending',
            price=360.00,
            amount=5,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=7),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=16,
            market='UNH',
            side='buy',
            status='completed',
            price=400.50,
            amount=8,
            filled=8,
            trigger='Market',
            good_til=None,
            execution_price=400.50,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=17,
            market='HD',
            side='sell',
            status='pending',
            price=320.00,
            amount=14,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=8),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=18,
            market='BAC',
            side='buy',
            status='completed',
            price=42.75,
            amount=60,
            filled=60,
            trigger='Market',
            good_til=None,
            execution_price=42.75,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=19,
            market='PG',
            side='sell',
            status='pending',
            price=140.00,
            amount=22,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=9),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=20,
            market='VZ',
            side='buy',
            status='completed',
            price=58.25,
            amount=35,
            filled=35,
            trigger='Market',
            good_til=None,
            execution_price=58.25,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=21,
            market='T',
            side='sell',
            status='pending',
            price=29.00,
            amount=45,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=10),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=22,
            market='KO',
            side='buy',
            status='completed',
            price=55.75,
            amount=28,
            filled=28,
            trigger='Market',
            good_til=None,
            execution_price=55.75,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=23,
            market='PEP',
            side='sell',
            status='pending',
            price=150.00,
            amount=16,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=11),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=24,
            market='MRK',
            side='buy',
            status='completed',
            price=80.50,
            amount=42,
            filled=42,
            trigger='Market',
            good_til=None,
            execution_price=80.50,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=25,
            market='ORCL',
            side='sell',
            status='pending',
            price=85.00,
            amount=30,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=12),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=26,
            market='IBM',
            side='buy',
            status='completed',
            price=125.75,
            amount=18,
            filled=18,
            trigger='Market',
            good_til=None,
            execution_price=125.75,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=27,
            market='INTC',
            side='sell',
            status='pending',
            price=60.00,
            amount=50,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=13),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=28,
            market='CSCO',
            side='buy',
            status='completed',
            price=55.25,
            amount=70,
            filled=70,
            trigger='Market',
            good_til=None,
            execution_price=55.25,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=29,
            market='CMCSA',
            side='sell',
            status='pending',
            price=45.00,
            amount=55,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=14),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=30,
            market='ADBE',
            side='buy',
            status='completed',
            price=500.75,
            amount=6,
            filled=6,
            trigger='Market',
            good_til=None,
            execution_price=500.75,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=31,
            market='CRM',
            side='sell',
            status='pending',
            price=250.00,
            amount=24,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=15),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=32,
            market='NFLX',
            side='buy',
            status='completed',
            price=550.75,
            amount=12,
            filled=12,
            trigger='Market',
            good_til=None,
            execution_price=550.75,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=33,
            market='PYPL',
            side='sell',
            status='pending',
            price=280.00,
            amount=20,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=16),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=34,
            market='SQ',
            side='buy',
            status='completed',
            price=240.50,
            amount=25,
            filled=25,
            trigger='Market',
            good_til=None,
            execution_price=240.50,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=35,
            market='UBER',
            side='sell',
            status='pending',
            price=45.00,
            amount=100,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=17),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=36,
            market='LYFT',
            side='buy',
            status='completed',
            price=50.25,
            amount=80,
            filled=80,
            trigger='Market',
            good_til=None,
            execution_price=50.25,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=37,
            market='SNAP',
            side='sell',
            status='pending',
            price=70.00,
            amount=60,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=18),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=38,
            market='ZM',
            side='buy',
            status='completed',
            price=350.75,
            amount=10,
            filled=10,
            trigger='Market',
            good_til=None,
            execution_price=350.75,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=39,
            market='SHOP',
            side='sell',
            status='pending',
            price=1300.00,
            amount=4,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=19),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=40,
            market='SQ',
            side='buy',
            status='completed',
            price=240.50,
            amount=15,
            filled=15,
            trigger='Market',
            good_til=None,
            execution_price=240.50,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=41,
            market='DOCU',
            side='sell',
            status='pending',
            price=260.00,
            amount=14,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=20),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=42,
            market='PINS',
            side='buy',
            status='completed',
            price=80.75,
            amount=50,
            filled=50,
            trigger='Market',
            good_til=None,
            execution_price=80.75,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=43,
            market='ROKU',
            side='sell',
            status='pending',
            price=400.00,
            amount=9,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=21),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=44,
            market='SPOT',
            side='buy',
            status='completed',
            price=220.50,
            amount=20,
            filled=20,
            trigger='Market',
            good_til=None,
            execution_price=220.50,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=45,
            market='SQ',
            side='sell',
            status='pending',
            price=240.00,
            amount=18,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=22),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=46,
            market='AAPL',
            side='buy',
            status='completed',
            price=150.25,
            amount=25,
            filled=25,
            trigger='Market',
            good_til=None,
            execution_price=150.25,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=47,
            market='GOOG',
            side='sell',
            status='pending',
            price=2500.00,
            amount=6,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=23),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=48,
            market='AMZN',
            side='buy',
            status='completed',
            price=3300.00,
            amount=3,
            filled=3,
            trigger='Market',
            good_til=None,
            execution_price=3300.00,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=49,
            market='TSLA',
            side='sell',
            status='pending',
            price=700.00,
            amount=12,
            filled=0,
            trigger='Limit',
            good_til=datetime.utcnow() + timedelta(days=24),
            execution_price=None,
            created_at=datetime.utcnow()
        ),
        Order(
            account_id=50,
            market='FB',
            side='buy',
            status='completed',
            price=350.00,
            amount=14,
            filled=14,
            trigger='Market',
            good_til=None,
            execution_price=350.00,
            created_at=datetime.utcnow()
        ),
    ]

    db.session.bulk_save_objects(orders)
    db.session.commit()
    print("Orders seeded")

def undo_orders():
    if environment == "production":
        db.session.execute(f"TRUNCATE table {SCHEMA}.orders RESTART IDENTITY CASCADE;")
    else:
        db.session.execute(text("DELETE FROM orders"))

    db.session.commit()
